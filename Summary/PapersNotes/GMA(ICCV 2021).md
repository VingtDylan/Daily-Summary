# GMA（ICCV 2021)

**Paper: Learning to Estimate Hidden Motions with Global Motion Aggregation**

<img src = "./../images/GMA1.png" align="center" style="width:100%">





**Occlusions**:一个被遮挡的点是在参考帧中成像但不在下一帧中的一个点，同时包括移出帧的点。 以前的工作依赖于 CNN 来学习遮挡，或者需要多个帧来使用时间平滑来推理遮挡。 在本文中，通过对图像自相似性进行建模，可以在两帧情况下更好地解决遮挡问题。 引入了全局运动聚合模块，这是一种基于transformer的方法，用于查找第一张图像中像素之间的远程依赖关系，并对相应的运动特征执行全局聚合。 

**Challenges: large motions, motion and defocus blur, featureless regions。**

定义Occlusions的含义: 遮挡点被定义为在参考帧中成像但在匹配帧中不可见的 3D 点。 这个定义结合了几种不同的场景，例如查询点移动到框架外或在另一个对象（或自身）后面，或者另一个对象在主动意义上移动到查询点前面。 

cost volume用于为像素的每个潜在位移提供匹配成本，然而，外观特征的相关性无法为学习遮挡区域的运动提供有意义的指导。 大多数现有方法在 MRF 中使用平滑度项来插值遮挡运动或使用 CNN 直接学习相邻关系，希望学习基于相邻像素估计遮挡运动。

 引入了全局运动聚合 (GMA) 模块，首先根据参考帧的自相似性计算注意力矩阵，然后使用该注意力矩阵来聚合运动特征。使用这些全局聚合的运动特征来增强成功的RAFT框架。

**Occlusions in optical flow:** 违反亮度恒定性约束，对光流估计提出了关键挑战。 大多数传统的光流算法将遮挡视为异常值，因此开发和优化鲁棒的目标函数。 在光流的持续优化中，Brox 等人使用 L1 范数是因为它对由遮挡或大亮度变化引起的异常值具有鲁棒性。 扎克等人增加了全变分正则化并提出了一种有效的数值方案来优化能量泛函。 这个配方后来被 Wedel 等人改进。后来的工作引入了额外的鲁棒优化项，包括 Charbonnier 势 和 Lorentzian 势 。 

最近，离散优化方法，特别是马尔可夫随机场（MRF)，已被用于估计光流。 这些算法首先使用鲁棒的截断数据项分别估计前向和后向流。 然后他们进行前向-后向一致性检查以确定被遮挡的区域。 最后，作为后处理步骤，他们使用插值方法来填充被遮挡区域的光流。 

其他工作将遮挡估计作为联合目标与光流估计结合在一起。 阿尔瓦雷斯等人使用前向-后向一致性作为优化目标，从而估计时间对称的光流。 除了前向-后向一致性外，MirrorFlow在能量函数中结合了遮挡 - 遮挡对称性并实现了性能改进。 由于遮挡是由 3D 运动引起的，其他工作明确地将局部深度关系建模为层并解释遮挡。 

本文没有使用显式遮挡推理来重载损失函数。 相反，采用了一种学习方法，类似于其他有监督的深度光流学习方法。目标不是明确地估计遮挡图，而是提高遮挡区域的光流精度。采用隐式方法来全局聚合运动特征，这提供了额外信息来正确预测遮挡区域的流量。与局部插值方法相反，该方法可以被认为是一种非局部插值方法。在深度学习中，遮挡问题已经在无监督学习设置中得到解决，然而，现有的监督学习方法都依赖于卷积来插入遮挡区域，这很容易导致更严重的闭塞失败。

**Self-attention and Transformers:** 这是第一个使用注意力的思想来解决光流问题的工作。与 Transformer不同的是，本文中不使用 self-attention，自注意力是指来自相同特征的查询、键和值向量。 在这里的例子中，查询和关键向量来自对图像外观建模的上下文特征，而值向量来自运动特征，这是相关体(cost correlation volume)的编码。



















## 参考分享

1. [Youtube](https://www.youtube.com/watch?v=cBNSQ8ZFKSE).
2. 























